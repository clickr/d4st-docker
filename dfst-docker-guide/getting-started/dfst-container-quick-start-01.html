<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>DFST Container Quick Start</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="schema.DC" href="http://purl.org/dc/terms/"><meta name="DC.Type" content="task"><meta name="description" content="If you are familiar with Docker you can follow these instructions to get going as quickly as possible."><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="Untitled9"><script type="text/javascript">var d4p = {"relativePath":"..\/..\/","dev":false,"debug":false,"draft":false,"nextTopicHref":"dfst-docker-guide\/getting-started\/docker-orientation.html","previousTopicHref":"dfst-docker-guide\/getting-started\/getting-started.html","ext":".html","root":false,"topic":{"chunked":""},"map":{"title":"\n      DITA for Small Teams\n        DFST Docker Usage Guide\n    ","chunked":false},"search":{"minlength":2},"l":{"searchPageHeading":"Search Results","close":"Close"}}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="../../themes/dita-d4p-classic/css/style.css"><link rel="stylesheet" type="text/css" media="screen, projection, print" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,
          
          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,
          
          // Optional callback... myCallback(i, width)
          callback: doc_resize,
          
          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  = mobile.css',
             // medium (size-1, size-2)
            '760px  to 980px  = 720.css',
            '980px  to 1270px = 960.css',
             // large (size-3, size-5)
            '1270px to 1600px = 1200.css',
            '1600px to 1940px = 1560.css',
             // extra large (size-6)
            '1940px to 2540px = 1920.css',
            '2540px           = 2520.css'
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="../../themes/dita-d4p-classic/js/script.js"></script></head><body class="en-us dita-d4p-classic centered navigation-default"><div id="d4h5-main-container" class="container_12" role="application"><header role="banner" aria-labelledby="publication-title" class="hide-for-small"><div class="grid_8"><h1 id="publication-title">
      DITA for Small Teams
        DFST Docker Usage Guide
    </h1></div><section class="grid_4 search-box"><form id="search" role="search"><div class="form-group"><input id="search-text" type="text" autocomplete="off" class="form-control" placeholder="Search"></div></form></section><secion class="clearfix"></secion></header><div id="d4h5-section-container" class="grid_12"><nav id="local-navigation" class="grid_4 alpha omega" role="navigation" aria-label="Main navigation"><div id="nav-content"><ul><li><a href="../../index.html">Table of Contents</a></li><li><a href="../frontmatter/about-dfst-docker-guide.html">About This Publication</a></li><li class="collapsible active"><a href="getting-started.html"><span class="enumeration enumeration0">Chapter 1. </span>Getting Started</a><ul><li class=" active"><a href="dfst-container-quick-start-01.html" class=" selected">DFST Container Quick Start</a></li><li><a href="docker-orientation.html">Getting Started With Docker</a></li><li><a href="virtual-box.html">VirtualBox Notes and Details</a></li></ul></li><li class="collapsible collapsed"><a href="../extending/extending_the_dfst_docker_system.html"><span class="enumeration enumeration0">Chapter 2. </span>Extending the DFST Docker System</a><ul><li><a href="../extending/building_the_dfst_containers.html">Building the DFST Containers</a></li><li><a href="../extending/configuring_your_own_containers.html">Configuring Your Own Containers</a></li></ul></li><li class="collapsible collapsed"><a href="../system-description/chapter-dfst-container-system-description.html"><span class="enumeration enumeration0">Chapter 3. </span>DFST Container System Description</a><ul><li><a href="../system-description/dfst-system-overview.html">DFST System Overview</a></li><li><a href="../system-description/dfst-system-configuration.html">DFST System Configuration</a></li></ul></li><li class="collapsible collapsed"><a href="../docker-container-ref/chapter-docker-container-ref.html"><span class="enumeration enumeration0">Chapter 4. </span>Docker Container Reference</a><ul><li><a href="../docker-container-ref/container-ref-dfst-dita-ot.html">dfst/dita-ot</a></li><li><a href="../docker-container-ref/container-ref-link-manager-basex.html">DFST Link Manager BaseX Docker Container</a></li><li><a href="../docker-container-ref/container-ref-dfst-gitlab.html">dfst/gitlab</a></li></ul></li><li class="collapsible collapsed"><a href="../../glossary/glossary.html">Glossary</a><ul><li class="collapsible collapsed"><a href="../../glossary/glossgroup-y.html">Y</a><ul><li><a href="../../glossary/gloss-yaml.html">YAML</a></li></ul></li></ul></li></ul></div></nav><div id="d4h5-main-content" class="grid_8 alpha omega"><article><nav id="content-toolbar" class="toolbar hide-for-small"></nav><section id="page"><div><a id="Untitled9" class="anchor"></a> <h1 class="title topictitle1">DFST Container Quick Start</h1> <div class="body taskbody"><p class="shortdesc">If you are familiar with Docker you can follow these instructions to get going as quickly as possible. </p> <div class="section prereq p" id="Untitled9-d753e11"> <p class="p">On Windows and OS X you must have the <a data-keyref="website-docker-toolbox" class="xref external" href="https://www.docker.com/docker-toolbox">Docker Toolbox</a> installed and running. See the Docker documentation for details on how to run Docker. All Docker commands are run from the Docker Quickstart Terminal </p> <p class="p props_platform_windows">Under Windows, open a Docker Quickstart Terminal window (<img class="inline  " id="Untitled9__image_xwr_mpb_bv" src="../../images/docker-quickstart-icon.png">)</p> <div class="p props_platform_mac">Under OS X you can use the Docker Quickstart Terminal shortcut (<img class="inline  " id="Untitled9__image_o3t_33c_bv" src="../../images/docker-quickstart-icon.png">) to start a new Docker terminal session. You can also make any terminal window docker-enabled by using this command from the command line:<pre class="pre codeblock">eval $(docker-machine env default)</pre>to set the Docker environment in your current terminal window. You can add this line to your ~/.profile script so that new terminal windows are automatically configured for Docker.</div> <aside class="note note "><span class="title">Note:</span> The Microsoft Edge brower's security settings may not allow you to connect to the Web applications running in the Docker containers. These instructions assume you have the Chrome browser installed and Firefox should work fine as well.</aside> <aside class="note note "><span class="title">Note:</span> The Docker environment is Linux-based, so even under Windows you will be using a Linux command line to use the <span class="keyword cmdname">dfst</span> command or use the <span class="keyword cmdname">docker</span> command directly. In this environment all file paths use forward slashes ("/") rather than back slashes ("\"). Absolute paths start with <span class="ph filepath">/c</span> rather than <span class="ph filepath">c:\</span>. For example, if your user directory is <span class="ph filepath">c:\Users\ekimber</span>, in a Docker terminal you would type <span class="ph filepath">/c/Users/ekimber</span>. For OS X users there is no difference.</aside> </div> <ol><li class="li step stepexpand"> <span class="ph cmd">Download the DITA for Small Teams <span class="ph filepath">dfst-docker</span> Zip package from the dita-for-small-teams project releases area:</span> <div class="itemgroup info"> <p class="p">Go to <a data-keyref="website-dfst-github-project-releases" class="xref external" href="https://github.com/dita-for-small-teams/dita-for-small-teams/releases">https://github.com/dita-for-small-teams/dita-for-small-teams/releases</a> and download the latest release. The Zip file will be named <span class="ph filepath">dfst-docker-<var class="keyword varname">v</var>-<var class="keyword varname">r</var>-<var class="keyword varname">m</var>.zip</span>, where <span class="ph filepath"><var class="keyword varname">v</var>-<var class="keyword varname">r</var>-<var class="keyword varname">m</var></span> is the version, release, and modification number, e.g. "1-1-0" for release 1.1.0.</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Unzip the DFST release package to somewhere convenient, e.g. <span class="ph filepath props_platform_windows">c:\temp</span>.</span> <div class="itemgroup stepresult"> <div class="p">You should get a directory named <span class="ph filepath">dfst-docker</span> with this content:<pre class="pre codeblock">&gt; cd c:\temp\dfst-docker
&gt; dir
LICENSE
README.md
containers
dfst</pre></div> <p class="p">The <span class="ph filepath">dfst</span> script is the main script for managing the DFST components through Docker. It is a bash shell script intended to be run in a Docker Quickstart Terminal under Windows or OS X.</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Start a Docker Quickstart Terminal (<img class="inline  " id="Untitled9__image_rnl_v3c_bv" src="../../images/docker-quickstart-icon.png">) and navigate to the directory for the DFST package:</span> <div class="itemgroup info"> <pre class="pre codeblock">ekimber@WIN-HH0I81E3DAU MINGW64 /c
$ cd temp/dfst-docker

ekimber@WIN-HH0I81E3DAU MINGW64 /c/temp/dfst-docker
$ ls
bin/  containers/  dfst  docs/  LICENSE  README.md</pre> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Run the command "<samp class="ph codeph">dfst start</samp>":</span> <div class="itemgroup info"> <pre class="pre codeblock">ekimber@WIN-HH0I81E3DAU MINGW64 /c/temp/dfst-docker
$ dfst start
Starting DFST Docker containers in the background. Use docker-compose commands or Kitematic to view the status.
Pulling redis (sameersbn/redis:latest)...
latest: Pulling from sameersbn/redis
… lots more messages here ...
Creating gitlab-dfst
<strong class="ph b">Docker machine IP address is '192.168.99.100'</strong>

Docker containers:
CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS                  PORTS                                                            NAMES
7971effdd6cb        dfst/gitlab-dfst              "/assets/wrapper"        3 seconds ago       Up Less than a second   0.0.0.0:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp, 0.0.0.0:8022-&gt;22/tcp   gitlab-dfst
aab650590a70        dfst/link-manager-basex       "/opt/basex/bin/basex"   2 minutes ago       Up 2 minutes            0.0.0.0:1984-&gt;1984/tcp, 0.0.0.0:8984-&gt;8984/tcp                   linkmgr-dfst
a280cacb6079        sameersbn/postgresql:9.4-12   "/sbin/entrypoint.sh"    2 minutes ago       Up 2 minutes            5432/tcp                                                         dfstdocker_postgresql_1
f15cb9d8c17a        sameersbn/redis:latest        "/sbin/entrypoint.sh"    4 minutes ago       Up 4 minutes            6379/tcp                                                         dfstdocker_redis_1
</pre> <p class="p">The first time you do this Docker has to download all the images for the containers and this can take a while. The next time you run it, it will be quick.</p> </div> <div class="itemgroup stepresult"> <p class="p">The DFST containers should start. It will take a minute or two for the Web services in the containers to start up completely.</p> </div> </li></ol><p class="li stepsection"> <p class="p">To make GitLab ready to use as a remote git repository you have to first set up the GitLab root user to match your user on the machine you're using. These steps should be automatable but so far I haven't been able to work out how to automate this configuration. Because of the way Docker persists (or doesn't persist) data, you may need to repeat these steps if the main Docker machine is reset, for example, if you reboot your machine. I am working hard on automating this configuration.</p> </p><ol start="5"><li class="li step stepexpand"> <span class="ph cmd">In the Docker terminal, type the command "<samp class="ph codeph">dfst gitlab</samp>" to open the GitLab Web application.</span> <div class="itemgroup stepresult"> <p class="p">Your browser should open to the GitLab login page:</p> <div xmlns="http://www.w3.org/1999/xhtml" class="fig fignone" id="Untitled9__fig_gwz_yjc_bv"><div class="figbody"> <img xmlns="" class="inline  " id="Untitled9__image_kkb_bkc_bv" src="../../images/gitlab-web-login-01.png"> </div><span class="figcap"><span class="enumeration fig-enumeration">Figure 1.&nbsp;</span>GitLab Login Screen</span></div> <p class="p">If your browser doesn't open, make sure you have Google Chrome installed.</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Log in as root using the password "5iveL!fe"</span> <div class="itemgroup stepresult"> <p class="p">You should be taken to the "New password" page.</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Enter "5iveL!fe" as the current password and set the new password to whatever you want.</span> <div class="itemgroup info">You will be using this password to authenticate using git so pick a password you can remember. The password will be reasonably secure as stored in the GitLab container so it should be safe to use your regular password.</div> <div class="itemgroup stepresult"> <p class="p">You should be taken back to the login screen so you can log in with your new password.</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Log in with the new password.</span> <div class="itemgroup stepresult"> <p class="p">You should go to the Projects page:</p> <div xmlns="http://www.w3.org/1999/xhtml" class="fig fignone" id="Untitled9__fig_kmj_5lc_bv"><div class="figbody"> <img xmlns="" class="inline  " id="Untitled9__image_xcz_vlc_bv" src="../../images/gitlab-web-projects-01.png" alt="GitLab projects page"> </div><span class="figcap"><span class="enumeration fig-enumeration">Figure 2.&nbsp;</span>GitLab Projects Page</span></div> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Navigate to the Admin user's profile settings:</span> <div class="itemgroup info"> <p class="p">Click on the user icon (<img class="inline  " id="Untitled9__image_vwq_4mc_bv" src="../../images/gitlab-user-icon-01.png" alt="User icon">), then on "account" (<img class="inline  " id="Untitled9__image_zqh_wmc_bv" src="../../images/gitlab-gear-icon-01.png" alt="Account icon">)</p> <p class="p">Scroll down to reveal the "Change Username" section:</p> <div xmlns="http://www.w3.org/1999/xhtml" class="fig fignone" id="Untitled9__fig_wvs_hnc_bv"><div class="figbody"> <img xmlns="" class="inline  " id="Untitled9__image_nq2_mnc_bv" src="../../images/gitlab-web-change-username-01.png"> </div><span class="figcap"><span class="enumeration fig-enumeration">Figure 3.&nbsp;</span>GitLab Change Username field</span></div> </div> </li><li class="li step stepexpand"> <span class="ph cmd">Change "root" to whatever user name you use on your machine, e.g. "ekimber" and save the user name.</span> <div class="itemgroup info"> <p class="p">You want to use your username so that when you use git commands everything works as you would expect.</p> <p class="p">This renaming of the root user is a workaround for as yet being unable to automatically configure new users in GitLab.</p> </div> </li></ol><p class="li stepsection"> <p class="p">At this point you should be ready to create new projects in GitLab and connect them to your local git repositories on your machine. You can use any git repository you have but for demo purposes the DITA Community DITA Demo content collection, the "Thunderbird" document set, has been included to make it easy to get started. To use it you just need to copy it out of it's container to your local machine.</p> </p><ol start="11"><li class="li step stepexpand"> <span class="ph cmd">In the Docker Quickstart Terminal do the following commands:</span> <div class="itemgroup info"> <pre class="pre codeblock">$ docker ps | grep demo</pre> <p class="p">This lists details for the demo content container. It should look like this:</p> <div class="p"> <pre class="pre codeblock">2c675bf0f308 ditacommunity/demo-content:latest "top" 15 minutes ago Up 15 minutes big_bhaskara</pre> </div> <p class="p">But more spread out. The last token on the line is the container name, in this example "big_bhaskara" (yours will likely be different).</p> <div class="p">Now move to the directory you want to add the <span class="ph filepath">Thunderbird</span> directory to:<pre class="pre codeblock">$ cd ~</pre></div> <p class="p">Finally, copy the files out of the demo data container:</p> <pre class="pre codeblock">$ docker cp big_bhaskara:/opt/dita-community/data/Thunderbird .</pre> <p class="p">This copies the <span class="ph filepath">Thunderbird</span> directory from the container to <span class="ph filepath">Thunderbird</span> under your home directory. You can use any target directory you want.</p> <p class="p">Test the copy:</p> <pre class="pre codeblock">$ ls ~/Thunderbird
c_about_defining_payload.dita      r_image_warehouse_2.dita
c_architecture_combined.dita       r_interface_drops.dita
c_architecture_overview.dita       r_interface-bypass-group-is-in-active-mode.dita
c_attribute_parameter_syntax.dita  r_jobconf.dita
… and many more files...</pre> </div> <div class="itemgroup stepresult"> <p class="p">You now have a copy of the Thunderbird data ready to push to your GitLab server following three more steps.</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">On the GitLab Projects page select the "New projects" button to create a new project.</span> <div class="itemgroup stepresult">The new project page will open.</div> </li><li class="li step stepexpand"> <span class="ph cmd">In the Project path field type "Thunderbird"</span> </li><li class="li step stepexpand"> <span class="ph cmd">In the Description field type something like "Demo content collection</span> </li><li class="li step stepexpand"> <span class="ph cmd">In the Visibility section select Public</span> </li><li class="li step stepexpand"> <span class="ph cmd">Select "Create project" to create the project</span> <div class="itemgroup stepresult"> <p class="p">The new project should be created in GitLab and you should now be at the project's GitLab page.</p> <p class="p">Notice the HTTP field with a URL in it. This is the git URL for this project. You will use this URL to connect your local git repository to this GitLab repository.</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">In a Docker Quickstart Terminal type the command:</span> <div class="itemgroup info"> <pre class="pre codeblock">$ docker exec gitlab-dfst add-custom-hooks</pre> </div> <div class="itemgroup stepresult"> <p class="p">The Thunderbird repository in the GitLab server should now be set up with the DFST custom hooks needed to connect GitLab to the DFST Link Manager.</p> <div class="p">If you want to verify that this happened you can use this command:<pre class="pre codeblock">$ docker exec -i gitlab-dfst ls /var/opt/gitlab/git-data/repositories/<var class="keyword varname">username</var>/Thunderbird.git/custom_hooks
BaseXClient.rb
post-receive
$ _</pre></div> <p class="p">Where <var class="keyword varname">username</var> is the user name you set up in GitLab. You should see the two files shown.</p> <p class="p">You must run this command any time you set up a new project in GitLab. It is safe to rerun at any time.</p> </div> </li></ol><p class="li stepsection"> <p class="p">You can now connect the local Thunderbird git repository to GitLab and push it to GitLab, which should then load it into the DFST Link Manager.</p> </p><ol start="18"><li class="li step stepexpand"> <span class="ph cmd">In a new Docker Quickstart Terminal, do the following commands:</span> <div class="itemgroup info"> <pre class="pre codeblock">$ cd ~/Thunderbird
$ git remote add origin http://192.168.99.100/<var class="keyword varname">username</var>/Thunderbird.git
$ git push origin master</pre> <p class="p">Where <var class="keyword varname">username</var> is the GitLab user name you set up earlier, e.g. "ekimber". You can also copy and paste this URL from the GitLab project page.</p> <p class="p">You should be asked to enter your user ID and password. These are the GitLab user ID and password you created earlier.</p> </div> <div class="itemgroup stepresult"> <p class="p">Nothing will happen for a few seconds to a minute and then you should see a lot of messages about files being added to the Link Manager. You may see a few errors as well (still working through some issues with git hooks on the GitLab server and the BaseX Ruby client).</p> </div> </li><li class="li step stepexpand"> <span class="ph cmd">In your original Docker Quickstart Terminal enter the command "<span class="keyword cmdname">dfst linkmgr</span>" to open the Link Manager Web application in a new browser window.</span> <div class="itemgroup stepresult"> <p class="p">The Link Manager application should open. You should see an entry like "Thunderbird/master" in the list repositories and branches. You can click on the branch to see the files in the branch.</p> </div> </li></ol> </div> <footer id="topicsNPLinks"><div id="footer_previous"><a href="../../dfst-docker-guide/getting-started/getting-started.html" class="previous" rel="internal">Getting Started</a></div><div id="footer_next"><a href="../../dfst-docker-guide/getting-started/docker-orientation.html" class="next" rel="internal">Getting Started With Docker</a></div></footer></div></section></article><div class="clear"></div></div><div class="clearfix"></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"></div></div></body></html>