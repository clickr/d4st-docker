<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Building the DFST Containers</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="schema.DC" href="http://purl.org/dc/terms/"><meta name="DC.Type" content="concept"><meta name="description" content="You can use the docker-compose command to build all the DFST containers in one go."><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="building_the_dfst_containers"><script type="text/javascript">var d4p = {"relativePath":"..\/..\/","dev":false,"debug":false,"draft":false,"nextTopicHref":"dfst-docker-guide\/extending\/configuring_your_own_containers.html","previousTopicHref":"dfst-docker-guide\/extending\/extending_the_dfst_docker_system.html","ext":".html","root":false,"topic":{"chunked":""},"map":{"title":"\n      DITA for Small Teams\n        DFST Docker Usage Guide\n    ","chunked":false},"search":{"minlength":2},"l":{"searchPageHeading":"Search Results","close":"Close"}}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="../../themes/dita-d4p-classic/css/style.css"><link rel="stylesheet" type="text/css" media="screen, projection, print" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,
          
          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,
          
          // Optional callback... myCallback(i, width)
          callback: doc_resize,
          
          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  = mobile.css',
             // medium (size-1, size-2)
            '760px  to 980px  = 720.css',
            '980px  to 1270px = 960.css',
             // large (size-3, size-5)
            '1270px to 1600px = 1200.css',
            '1600px to 1940px = 1560.css',
             // extra large (size-6)
            '1940px to 2540px = 1920.css',
            '2540px           = 2520.css'
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="../../themes/dita-d4p-classic/js/script.js"></script></head><body class="en-us dita-d4p-classic centered navigation-default"><div id="d4h5-main-container" class="container_12" role="application"><header role="banner" aria-labelledby="publication-title" class="hide-for-small"><div class="grid_8"><h1 id="publication-title">
      DITA for Small Teams
        DFST Docker Usage Guide
    </h1></div><section class="grid_4 search-box"><form id="search" role="search"><div class="form-group"><input id="search-text" type="text" autocomplete="off" class="form-control" placeholder="Search"></div></form></section><secion class="clearfix"></secion></header><div id="d4h5-section-container" class="grid_12"><nav id="local-navigation" class="grid_4 alpha omega" role="navigation" aria-label="Main navigation"><div id="nav-content"><ul><li><a href="../../index.html">Table of Contents</a></li><li><a href="../frontmatter/about-dfst-docker-guide.html">About This Publication</a></li><li class="collapsible collapsed"><a href="../getting-started/getting-started.html"><span class="enumeration enumeration0">Chapter 1. </span>Getting Started</a><ul><li><a href="../getting-started/dfst-container-quick-start-01.html">DFST Container Quick Start</a></li><li><a href="../getting-started/docker-orientation.html">Getting Started With Docker</a></li><li><a href="../getting-started/virtual-box.html">VirtualBox Notes and Details</a></li></ul></li><li class="collapsible active"><a href="extending_the_dfst_docker_system.html"><span class="enumeration enumeration0">Chapter 2. </span>Extending the DFST Docker System</a><ul><li class=" active"><a href="building_the_dfst_containers.html" class=" selected">Building the DFST Containers</a></li><li><a href="configuring_your_own_containers.html">Configuring Your Own Containers</a></li></ul></li><li class="collapsible collapsed"><a href="../system-description/chapter-dfst-container-system-description.html"><span class="enumeration enumeration0">Chapter 3. </span>DFST Container System Description</a><ul><li><a href="../system-description/dfst-system-overview.html">DFST System Overview</a></li><li><a href="../system-description/dfst-system-configuration.html">DFST System Configuration</a></li></ul></li><li class="collapsible collapsed"><a href="../docker-container-ref/chapter-docker-container-ref.html"><span class="enumeration enumeration0">Chapter 4. </span>Docker Container Reference</a><ul><li><a href="../docker-container-ref/container-ref-dfst-dita-ot.html">dfst/dita-ot</a></li><li><a href="../docker-container-ref/container-ref-link-manager-basex.html">DFST Link Manager BaseX Docker Container</a></li><li><a href="../docker-container-ref/container-ref-dfst-gitlab.html">dfst/gitlab</a></li></ul></li><li class="collapsible collapsed"><a href="../../glossary/glossary.html">Glossary</a><ul><li class="collapsible collapsed"><a href="../../glossary/glossgroup-y.html">Y</a><ul><li><a href="../../glossary/gloss-yaml.html">YAML</a></li></ul></li></ul></li></ul></div></nav><div id="d4h5-main-content" class="grid_8 alpha omega"><article><nav id="content-toolbar" class="toolbar hide-for-small"></nav><section id="page"><div><a id="building_the_dfst_containers" class="anchor"></a> <h1 class="title topictitle1">Building the DFST Containers</h1> <div class="body conbody"><p class="shortdesc">You can use the <span class="keyword cmdname">docker-compose</span> command to build all the DFST containers in one go.</p> <p class="p">The <span class="keyword cmdname">docker-compose</span> command runs against a <a href="../../glossary/gloss-yaml.html" title="YAML Ain't Markup LanguageWhat It Is: YAML is a human friendly data serialization&#xA;      standard for all programming languages. See "><dfn class="term" data-keyref="gloss-yaml">YAML</dfn></a> file and builds or runs the containers defined in the YAML file. By default the file is named <span class="ph filepath">docker-compose.yml</span> and is expected to be in the directory you run the <span class="keyword cmdname">docker-compose</span> command in. </p> <div class="p">You must define the environment variable <var class="keyword varname">HOSTNAME</var> with the IP address or host name you will use to connect to the running containers. Under OS X and Windows this is the IP address of the Docker machine that will run the containers. You can get the IP address using the <samp class="ph codeph">docker-machine ip default</samp> command:<pre class="pre codeblock">$ docker-machine ip default
192.168.99.100
$_</pre></div> <div class="p">On OS X you can set the environment variable dynamically like so:<pre class="pre codeblock">$ export HOSTNAME=$(docker-machine ip default)
$ echo $HOSTNAME
192.168.99.100
$ _</pre></div> <div class="p">For the DFST project there are two top-level <span class="ph filepath">docker-compose.yml</span> files:<ul class="ul" id="building_the_dfst_containers__ul_wpr_sby_w5"> <li class="li"><span class="ph filepath">./docker-compose/dfst-build/docker-compose.yml</span><p class="p">Manages building the DFST containers using the YAML files in each container's directory</p></li> <li class="li"><span class="ph filepath">./docker-compose/dfst-server/docker-compose.yml</span><p class="p">Runs the DFST containers using container images. If the images have not been built locally then they'll be fetched from the Docker hub.</p></li> </ul></div> <div class="p">To build the images, simply navigate to the <span class="ph filepath">./docker-compose/dfst-build/docker-compose.yml</span> directory and run the command <samp class="ph codeph">docker-compose build</samp>:<pre class="pre codeblock">$ cd ~/workspace/docker-compose/dfst-build
$ docker-compose build
Building dita-ot
Step 1 : FROM dfst/dita-ot
 ---&gt; 98b7682e9180
Successfully built 98b7682e9180
Building git-server
Step 1 : FROM gitlab/gitlab-ce
 ---&gt; ce51895e10d9
Step 2 : CMD /assets/wrapper
 ---&gt; Using cache
 ---&gt; 4f9c9516bb40
Successfully built 4f9c9516bb40
$ _</pre></div> <p class="p">If the images on which these containers depend have not yet been downloaded you will see additional messages as those images are fetched.</p> <aside class="note note "><span class="title">Note:</span> As of <span class="keyword cmdname">docker-compose</span> 1.5.2, there is no way to explicitly tag the images. They will be assigned a generated repository and image name based on the service name, so you can't use the <span class="keyword cmdname">docker-compose</span> build process to directly produce images that will be run by the separate dfst-server <span class="ph filepath">docker-compose.yml</span> file (which refers to the images as pushed to the Docker hub).</aside> <div class="p">You can also build and run the images immediately by using "<span class="keyword cmdname">up</span>" instead of "<span class="keyword cmdname">build</span>":<pre class="pre codeblock">$ docker-compose up -d
Starting dfstbuild_dita-ot_1
Starting dfstbuild_linkmgr_1
Starting dfstbuild_git-server_1
$ _</pre></div> <div class="p">This starts the link manager and git server in the background. You can use normal Docker commands or Kitematic to manage the running containers or you can use the <samp class="ph codeph">docker-compose stop</samp> command to stop the containers:<pre class="pre codeblock">$ docker-compose stop
Stopping dfstbuild_git-server_1 ... done
Stopping dfstbuild_linkmgr_1 ... done
$ _</pre></div> <p class="p">Note that the DITA OT container doesn't run—it just gets started and immediately exits as it is only there to provide data volumes—so you will only see stop messages for the git server and link manager.</p> <div class="p">After you stop the containers the containers are still there. You can restart them or remove them entirely using the <samp class="ph codeph">docker-compose rm</samp> command:<pre class="pre codeblock">$ docker-compose rm
Going to remove dfstbuild_git-server_1, dfstbuild_linkmgr_1, dfstbuild_dita-ot_1
Are you sure? [yN] y
Removing dfstbuild_git-server_1 ... done
Removing dfstbuild_linkmgr_1 ... done
Removing dfstbuild_dita-ot_1 ... done
$ _</pre></div> <div class="p">You can use the <span class="keyword parmname">-v</span> parameter to force removal:<pre class="pre codeblock">$ docker-compose rm -f
Going to remove dfstbuild_git-server_1, dfstbuild_linkmgr_1, dfstbuild_dita-ot_1
Removing dfstbuild_git-server_1 ... done
Removing dfstbuild_linkmgr_1 ... done
Removing dfstbuild_dita-ot_1 ... done
$ _</pre></div> </div> <footer id="topicsNPLinks"><div id="footer_previous"><a href="../../dfst-docker-guide/extending/extending_the_dfst_docker_system.html" class="previous" rel="internal">Extending the DFST Docker System</a></div><div id="footer_next"><a href="../../dfst-docker-guide/extending/configuring_your_own_containers.html" class="next" rel="internal">Configuring Your Own Containers</a></div></footer></div></section></article><div class="clear"></div></div><div class="clearfix"></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"></div></div></body></html>